import{Y as s,h as a,L as o,l as e,C as t,c as l,w as i,i as d,o as r,a as c,f as n,t as p,e as u,q as g,N as _}from"./index-C5AUwsom.js";import{_ as f}from"./uni-pay.BsdVsTtW.js";import{r as h}from"./uni-app.es.BQZf9WqO.js";import{_ as y}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./js_sdk.Dqq72uFy.js";const m=s.importObject("goods");s.importObject("uni-pay-co");const j=y({data:()=>({goods:{title:"加载中"},order:0,address:""}),methods:{async getgoods(s){let a=await m.getGoods(s);this.goods=a[0]},async getOrder(){let s=await this.$refs.pay.getOrder({out_trade_no:this.trade_no,await_notify:!0});s&&(console.log(s.status),1===s.status&&this.paySuccess())},paySuccess(){a({url:"/pages/apps/ershou/ershou"})},payCancel(){o({title:"支付已取消"})},payfail(s){o({title:"支付失败",content:s.errMsg})},alipay(){this.order_no="test"+Date.now(),this.$refs.pay.open({total_fee:Math.round(100*(this.goods.price-0)),order_no:this.order_no,out_trade_no:this.order_no,description:this.goods.title,type:"goods",custom:{_id:this.goods._id,id:e("userid"),address:this.address}})}},mounted(){this.getgoods()},onLoad(s){},onShow(){this.getOrder()}},[["render",function(s,a,o,e,y,m){const j=h(t("uni-pay"),f),C=d,S=g,b=_;return r(),l(C,{class:"page"},{default:i((()=>[c(j,{ref:"pay",height:"70vh",onSuccess:s.success,onFail:s.fail,logo:"/static/logo.png"},null,8,["onSuccess","onFail"]),c(C,{class:"topbox"},{default:i((()=>[c(C,{class:"title"},{default:i((()=>[n("订单详情")])),_:1})])),_:1}),c(C,{class:"appbox"},{default:i((()=>[c(S,{mode:"aspectFill",class:"mainimg",src:y.goods.imgUrl},null,8,["src"]),c(C,{class:"goods-title"},{default:i((()=>[n(p(y.goods.title),1)])),_:1}),c(b,{placeholder:"请简要描述交易时间地点等",modelValue:y.address,"onUpdate:modelValue":a[0]||(a[0]=s=>y.address=s),class:"address"},null,8,["modelValue"]),c(C,{class:"price"},{default:i((()=>[n("￥"+p(y.goods.price),1)])),_:1}),c(C,{class:"buttonpake"},{default:i((()=>[c(C,{onClick:m.alipay,class:"alipay"},{default:i((()=>[n("立即支付 "),u("i",{class:"bi bi-cart-check-fill"})])),_:1},8,["onClick"])])),_:1}),c(j,{onCancel:m.payCancel,onFail:m.payfail,onSuccess:m.paySuccess,ref:"pay"},null,8,["onCancel","onFail","onSuccess"])])),_:1})])),_:1})}],["__scopeId","data-v-9e475f34"]]);export{j as default};
