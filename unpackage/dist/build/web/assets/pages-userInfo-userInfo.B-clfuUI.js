import{g as s,m as t,v as e,x as i,j as a,y as o,s as l,c as n,w as u,i as c,o as g,a as f,f as r,t as d,e as m,z as h,b as x}from"./index-HXBhxmPW.js";import{b as y}from"./base.CIiHcDGk.js";import{_ as b}from"./_plugin-vue_export-helper.BCo6x5W8.js";const k=s.importObject("userInfo",{customUI:!0});const _=b({data:()=>({loginstate:t("loginstate"),name:t("username"),xueyuan:t("userxueyuan"),id:t("userid"),fx:t("userfx"),zy:t("userzy")}),methods:{logout(){var s=this;e({url:y.baseUrl+"logout",success(){s.checkLogin(),i({title:"已退出登录",duration:2e3})}})},gotologin(){a({url:"/pages/login/login"})},checkLogin(){console.log(this.loginstate,this.name),e({url:y.baseUrl+"cjcx/cjcx_cxXsgrcj.html?doType=query&xnm=2022&xqm=3",success:s=>{null!=s.data.length?(console.log("登录失效"),null==this.loginstate||"logout"==this.loginstate?this.loginstate="logout":this.loginstate="offline"):(this.loginstate="online",this.name=s.data.items[0].xm,this.xueyuan=s.data.items[0].zsxymc,this.id=s.data.items[0].xh,this.fx=s.data.items[0].zyfxmc,this.zy=s.data.items[0].zymc,k.userlogin({name:s.data.items[0].xm,id:this.id=s.data.items[0].xh,zy:s.data.items[0].zymc,balance:0}),o({success:s=>{k.setcid({id:this.id,cid:s.cid})},fail(s){console.log(s)}})),l("loginstate",this.loginstate),l("username",this.name),l("userxueyuan",this.xueyuan),l("userid",this.id),l("userfx",this.fx),l("userzy",this.zy)},fail(s){console.log("失败"+s)}})}},mounted(){this.checkLogin()}},[["render",function(s,t,e,i,a,o){const l=c;return g(),n(l,null,{default:u((()=>[f(l,{class:"topbox"},{default:u((()=>["offline"!=a.loginstate?(g(),n(l,{key:0,class:"namebox"},{default:u((()=>[r(d(a.name),1),m("i",{class:"bi bi-caret-right-fill"})])),_:1})):h("",!0),"offline"==a.loginstate?(g(),n(l,{key:1,onClick:o.gotologin,class:"namebox"},{default:u((()=>[r("立即登录"),m("i",{class:"bi bi-caret-right-fill"})])),_:1},8,["onClick"])):h("",!0),"offline"!=a.loginstate?(g(),n(l,{key:2,class:"schoolnamebox"},{default:u((()=>[r(d(a.xueyuan),1)])),_:1})):h("",!0),f(l,{class:"avtarbox"},{default:u((()=>[m("i",{class:"bi bi-person-fill"})])),_:1})])),_:1}),f(l,{class:"infobox"},{default:u((()=>["offline"!=a.loginstate?(g(),n(l,{key:0},{default:u((()=>[r("学号:"+d(a.id),1)])),_:1})):h("",!0),"offline"!=a.loginstate?(g(),n(l,{key:1},{default:u((()=>[r("专业:"+d(a.zy),1)])),_:1})):h("",!0),"offline"!=a.loginstate?(g(),n(l,{key:2},{default:u((()=>[r("方向:"+d(a.fx),1)])),_:1})):h("",!0),"logout"==a.loginstate?(g(),x("i",{key:3,onClick:t[0]||(t[0]=(...s)=>o.gotologin&&o.gotologin(...s)),class:"bi bi-arrow-clockwise refresh"})):h("",!0)])),_:1}),"online"==a.loginstate?(g(),n(l,{key:0,onClick:o.logout,class:"quitbutton"},{default:u((()=>[r("退出登录")])),_:1},8,["onClick"])):h("",!0)])),_:1})}],["__scopeId","data-v-bb434619"]]);export{_ as default};
