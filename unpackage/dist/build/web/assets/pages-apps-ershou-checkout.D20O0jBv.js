import{g as s,j as a,M as e,m as o,D as t,c as l,w as d,i,o as r,a as c,f as n,t as p,e as u,u as g,O as _}from"./index-HXBhxmPW.js";import{_ as f}from"./uni-pay.BARgGD5-.js";import{r as h}from"./uni-app.es.CpUiba3j.js";import{_ as m}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./js_sdk.Dqq72uFy.js";const y=s.importObject("goods");s.importObject("uni-pay-co");const j=m({data:()=>({goods:{title:"加载中"},order:0,address:""}),methods:{async getgoods(s){let a=await y.getGoods(s);this.goods=a[0]},async getOrder(){let s=await this.$refs.pay.getOrder({out_trade_no:this.trade_no,await_notify:!0});s&&(console.log(s.status),1===s.status&&this.paySuccess())},paySuccess(){console.log("pay success"),a({url:"/pages/apps/ershou/ershou"})},payCancel(){e({title:"支付已取消"})},payfail(s){e({title:"支付失败",content:s.errMsg})},alipay(){this.order_no="test"+Date.now(),this.$refs.pay.open({total_fee:Math.round(100*(this.goods.price-0)),order_no:this.order_no,out_trade_no:this.order_no,description:this.goods.title,type:"goods",custom:{_id:this.goods._id,id:o("userid"),address:this.address}})}},mounted(){},onLoad(s){this.getgoods(s.id)},onShow(){this.getOrder()}},[["render",function(s,a,e,o,m,y){const j=i,b=g,C=_,w=h(t("uni-pay"),f);return r(),l(j,{class:"page"},{default:d((()=>[c(j,{class:"topbox"},{default:d((()=>[c(j,{class:"title"},{default:d((()=>[n("订单详情")])),_:1})])),_:1}),c(j,{class:"appbox"},{default:d((()=>[c(b,{mode:"aspectFill",class:"mainimg",src:m.goods.imgUrl},null,8,["src"]),c(j,{class:"goods-title"},{default:d((()=>[n(p(m.goods.title),1)])),_:1}),c(C,{placeholder:"请简要描述交易时间地点等",modelValue:m.address,"onUpdate:modelValue":a[0]||(a[0]=s=>m.address=s),class:"address"},null,8,["modelValue"]),c(j,{class:"price"},{default:d((()=>[n("￥"+p(m.goods.price),1)])),_:1}),c(j,{class:"buttonpake"},{default:d((()=>[c(j,{onClick:y.alipay,class:"alipay"},{default:d((()=>[n("立即支付 "),u("i",{class:"bi bi-cart-check-fill"})])),_:1},8,["onClick"])])),_:1})])),_:1}),c(w,{onCancel:y.payCancel,onFail:y.payfail,onSuccess:y.paySuccess,ref:"pay"},null,8,["onCancel","onFail","onSuccess"])])),_:1})}],["__scopeId","data-v-c305354e"]]);export{j as default};
