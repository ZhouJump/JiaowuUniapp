import{I as t,J as e,o as s,c as i,w as n,b as a,F as o,r as l,d as c,n as r,K as u,a as d,e as m,i as h,L as p,l as f,s as g,v as I,C as x,f as L,t as Y,z as _,S as y,p as w}from"./index-Dkb7w5wx.js";import{_ as C}from"./_plugin-vue_export-helper.BCo6x5W8.js";import{r as b}from"./uni-app.es.D4vXMl6B.js";const v=C({__name:"m-drag",props:{itemHeight:{type:Number,required:!0},list:{type:Array,required:!0},readonly:{type:Boolean,default:!1}},emits:["change"],setup(f,{emit:g}){const I=g,x=f,L=t({newList:[],initialItemYList:[],itemYList:[],touchY:0,currentItemY:{},currentIndex:-1});function Y(){return x.list.map(((t,e)=>({left:0,top:e*x.itemHeight})))}function _(t){if(x.readonly)return;const[{pageY:e}]=t.touches,s=L.itemYList[L.currentIndex],i=L.itemYList[L.currentIndex-1],n=L.itemYList[L.currentIndex+1];L.itemYList[L.currentIndex]={top:s.top+(e-L.touchY)},L.touchY=e,n&&s.top>n.top-x.itemHeight/2?w(L.currentIndex+1):i&&s.top<i.top+x.itemHeight/2&&w(L.currentIndex-1)}function y(){x.readonly||(I("change",L.newList,L.newList[L.currentIndex]),L.itemYList[L.currentIndex]=L.initialItemYList[L.currentIndex],L.currentIndex=-1,C(!0))}function w(t){console.log(t);const e=L.newList[L.currentIndex];L.newList[L.currentIndex]=L.newList[t],L.newList[t]=e,L.itemYList[t]=L.itemYList[L.currentIndex],L.itemYList[L.currentIndex]=L.currentItemY,L.currentIndex=t,L.currentItemY=L.initialItemYList[L.currentIndex]}function C(t){document.body.style.overflow=t?"initial":"hidden"}return e((()=>x.list),(t=>{(null==t?void 0:t.length)&&(L.newList=t,L.initialItemYList=Y(),L.itemYList=Y())}),{immediate:!0}),(t,e)=>{const g=h,I=p;return s(),i(I,{class:"m-drag","scroll-y":"",style:r({height:f.itemHeight*L.newList.length+"px"})},{default:n((()=>[(s(!0),a(o,null,l(L.newList,((e,a)=>(s(),i(g,{key:a,class:c(["m-drag-item",{active:L.currentIndex===a}]),style:r({top:L.itemYList[a].top+"px"})},{default:n((()=>[u(t.$slots,"default",{item:e},void 0,!0),d(g,{class:"icon",onTouchstart:t=>function(t,e){if(x.readonly)return;C(!1);const[{pageY:s}]=t.touches;L.currentIndex=e,L.touchY=s,L.currentItemY=L.itemYList[e]}(t,a),onTouchmove:_,onTouchend:y},{default:n((()=>[m("i",{class:"lines"})])),_:2},1032,["onTouchstart"])])),_:2},1032,["class","style"])))),128))])),_:3},8,["style"])}}},[["__scopeId","data-v-8787b35b"]]);const k=C({data:()=>({choose:0,comlist:""!=f("comlist")?JSON.parse(f("comlist")):"",comshop:[{name:"近期考试",id:"kaoshi"},{name:"今日课程",id:"kecheng"},{name:"每日一言",id:"yiyan"},{name:"舔狗日记",id:"tiangou"},{name:"ACG日报",id:"acgnews"}]}),methods:{changepage(t){this.choose=t.detail.current},dragComplete(t,e){g("comlist",JSON.stringify(t))},add(t){this.comlist=[...this.comlist,t],g("comlist",JSON.stringify(this.comlist)),I({title:t.name+"已添加至主页",position:"center",duration:2e3})},del(t){let e=this.comlist.findIndex((e=>e===t));this.comlist.splice(e,1),g("comlist",JSON.stringify(this.comlist))}},mounted(){}},[["render",function(t,e,r,u,p,f){const g=_,I=h,C=b(x("m-drag"),v),k=y,H=w;return s(),i(I,null,{default:n((()=>[d(I,{class:"topbox"},{default:n((()=>[d(I,{class:"title"},{default:n((()=>[d(g,{onClick:e[0]||(e[0]=t=>p.choose=0),class:c({titlechoose:0==p.choose})},{default:n((()=>[L("我的组件")])),_:1},8,["class"]),d(g,{onClick:e[1]||(e[1]=t=>p.choose=1),class:c({titlechoose:1==p.choose})},{default:n((()=>[L("组件商店")])),_:1},8,["class"])])),_:1})])),_:1}),d(I,{class:"appbox"},{default:n((()=>[d(H,{current:p.choose,onChange:f.changepage,duration:"100",class:"swiper"},{default:n((()=>[d(k,null,{default:n((()=>[d(I,{class:"mycom"},{default:n((()=>[d(C,{"item-height":100,list:p.comlist,onChange:f.dragComplete},{default:n((({item:t})=>[d(I,{class:"item"},{default:n((()=>[L(Y(t.name)+" ",1),m("i",{onClick:e=>f.del(t),style:{float:"right"},class:"bi bi-trash-fill del"},null,8,["onClick"])])),_:2},1024)])),_:1},8,["list","onChange"])])),_:1})])),_:1}),d(k,null,{default:n((()=>[d(I,{class:"comshop"},{default:n((()=>[(s(!0),a(o,null,l(p.comshop,((t,e)=>(s(),i(I,{class:"item"},{default:n((()=>[L(Y(t.name)+" ",1),m("i",{onClick:e=>f.add(t),style:{float:"right"},class:"bi bi-plus-lg del"},null,8,["onClick"])])),_:2},1024)))),256))])),_:1})])),_:1})])),_:1},8,["current","onChange"])])),_:1})])),_:1})}],["__scopeId","data-v-25ea3819"]]);export{k as default};
