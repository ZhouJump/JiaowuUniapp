import{o as e,c as s,w as a,a as t,n as o,b as i,r as n,F as l,i as r,d as u,e as p,f as m,t as c,Y as d,g,s as f,h,j as _,k as b,l as v,m as y,S as k,p as j,q as x}from"./index-C5AUwsom.js";import{_ as w}from"./_plugin-vue_export-helper.BCo6x5W8.js";import I from"./pages-apps-apps.BNOKxfTG.js";import L from"./pages-userInfo-userInfo.BZzhKPl_.js";import S from"./pages-home-home.BQRmc87a.js";import"./base.CIiHcDGk.js";import"./pages-home-setting.BVScozMk.js";import"./pages-home-yiyan.B6iVHr88.js";import"./pages-home-tiangou.8tL-PcBT.js";import"./pages-home-acgnews.CxCRsX0-.js";const N=w({name:"tabbar",props:{value:Number},methods:{tabTap(e){this.$emit("input",e)},load(){setTimeout((()=>{this.loadok=1}),1e3)}},mounted(){this.load()},data:()=>({tabbarList:[{pagePath:"pages/index/index",text:"应用",icon:"bi-grid-3x3-gap-fill"},{pagePath:"pages/index/index",text:"主页",icon:"bi-map-fill"},{pagePath:"pages/userInfo/userInfo",text:"我的",icon:"bi-person-fill"}],loadok:!1})},[["render",function(d,g,f,h,_,b){const v=r;return e(),s(v,{class:"tabbar"},{default:a((()=>[t(v,{class:"shadow",style:o({left:33.33*f.value+"%",opacity:_.loadok?"":"0"})},null,8,["style"]),(e(!0),i(l,null,n(_.tabbarList,((t,o)=>(e(),s(v,{onClick:e=>b.tabTap(o),class:u(f.value==o&&_.loadok?"itemSelect":"item")},{default:a((()=>[p("i",{class:u(["bi",t.icon])},null,2),m(" "+c(t.text),1)])),_:2},1032,["onClick","class"])))),256))])),_:1})}],["__scopeId","data-v-a43c8e6e"]]);function P(){return new Promise(((e,s)=>{new Promise(((e,s)=>{s({message:"请在App中使用"})})).then((async a=>{const t=a.code,o=a.message,i=a.url;if(t>0){const s=await d.getTempFileURL({fileList:[i]});return void 0!==s.fileList[0].tempFileURL&&(a.url=s.fileList[0].tempFileURL),a.is_silently?void g({url:i,success:e=>{200==e.statusCode&&plus.runtime.install(e.tempFilePath,{force:!1})}}):(f("__package_info__",a),h({url:"/uni_modules/uni-upgrade-center-app/pages/upgrade-popup?local_storage_key=__package_info__",fail:e=>{console.error("更新弹框跳转失败",e),_("__package_info__")}}),e(a))}return t<0?(console.error(o),s(a)):e(a)})).catch((e=>{s(e)}))}))}const C=d.importObject("userInfo",{customUI:!0});const F=w({data:()=>({selected:1,loadok:!1,message:{message:[]}}),components:{tabbar:N,appsVue:I,userInfoVue:L,homeVue:S},onLoad(){},methods:{changepage(e){this.selected=e.detail.current},openpush(){b((e=>{console.log("收到推送消息：",e),this.message=JSON.parse(v("message"+e.data.payload.id))||{message:[]},this.sentmeaasge(e.data.payload)}))},sentmeaasge(e){let s=e;s.sent=!1,this.message.message.unshift(s),f("message"+e.id,JSON.stringify(this.message)),this.insertmsg(s)},async insertmsg(e){let s=v("message");s=""==s?{msg:[]}:JSON.parse(s);let a=!1;if(s.msg.forEach(((t,o)=>{t.id==e.id&&(a=!0,s.msg[o].chat=e,s.msg.unshift(s.msg.splice(o,1)[0]))})),0==a){let a=await C.getuser({id:e.id});s.msg.unshift({id:e.id,name:a.name,chat:e})}f("message",JSON.stringify(s))}},onShow(){this.$refs.userinfovue.checkLogin(),this.$refs.homevue.refresh()},onReady(){setTimeout((()=>{this.loadok=!0,plus.navigator.closeSplashscreen()}),600),this.openpush(),P()}},[["render",function(i,n,l,u,p,m){const c=y("apps-vue"),d=k,g=y("home-vue"),f=y("user-info-vue"),h=j,_=x,b=y("tabbar"),v=r;return e(),s(v,null,{default:a((()=>[t(h,{circular:"",current:p.selected,duration:"200",class:"swiper",onChange:m.changepage},{default:a((()=>[t(d,null,{default:a((()=>[t(c,{ref:"appsvue"},null,512)])),_:1}),t(d,null,{default:a((()=>[t(g,{ref:"homevue"},null,512)])),_:1}),t(d,null,{default:a((()=>[t(f,{ref:"userinfovue"},null,512)])),_:1})])),_:1},8,["current","onChange"]),t(_,{style:o({animationName:p.loadok?"boot":""}),src:"/assets/cover-w1sKUm6Q.png",class:"boot"},null,8,["style"]),t(b,{value:p.selected,onInput:n[0]||(n[0]=e=>p.selected=e)},null,8,["value"])])),_:1})}],["__scopeId","data-v-187de99a"]]);export{F as default};
