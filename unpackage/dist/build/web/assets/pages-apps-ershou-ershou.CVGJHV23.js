import{g as s,m as e,j as l,M as t,E as a,N as i,x as o,c,w as d,i as u,o as r,a as n,d as h,f,e as g,b as p,r as m,F as _,n as b,t as y,B as w,C as k,A as v,O as C,u as x,S as I,Q as U,q as j}from"./index-BFUhPeOX.js";import{_ as V}from"./_plugin-vue_export-helper.BCo6x5W8.js";const F=s.importObject("goods",{customUI:!0}),q=s.importObject("userInfo",{customUI:!0});const G=V({data:()=>({choose:0,currchoose:0,goodlist:[{title:"加载中",price:"加载中",imgUrl:""}],mygood:[],id:e("userid"),name:e("username"),selltitle:"",sellprice:"",imgurl:"",fitterway:[1,1],isloading:!1,userinfo:{},message:{msg:[]},timer:""}),methods:{gotoxiangqing(s){l({url:"/pages/apps/ershou/xiangqin?id="+s})},searchgoods(s){console.log(s.detail.value),this.goodlist.forEach((e=>{e.title.includes(s.detail.value)||""==s.detail.value?e.show=!0:e.show=!1}))},pricefitter(){0==this.fitterway[0]&&(this.fitterway[1]=!this.fitterway[1]),this.fitterway[0]=0;let s=0;s=this.fitterway[1]?1:-1,this.goodlist.sort(((e,l)=>e.price-0<l.price-0?-1*s:e.price-0>l.price-0?1*s:0))},datefitter(){1==this.fitterway[0]&&(this.fitterway[1]=!this.fitterway[1]),this.fitterway[0]=1;let s=0;s=this.fitterway[1]?1:-1,this.goodlist.sort(((e,l)=>e.date<l.date?-1*s:e.date>l.date?1*s:0))},clickadd(){1==this.choose?this.choose=this.currchoose:(this.currchoose=this.choose,this.choose=1)},changepage(s){this.choose=s.detail.current},checklogin(){""==this.id&&t({title:"请先登录",success:s=>{a(1),s.confirm&&l({url:"/pages/login/login"})}})},chooseimg(){i({sizeType:"compressed",count:1,success:s=>{this.imgurl=s.tempFilePaths[0]}})},async getgoods(){this.goodlist=await F.getGoods()},async uploadGoods(){if(1!=this.isloading)if(""!=this.imgurl&&""!=this.selltitle&&""!=this.sellprice){this.isloading=!0;let e=Date.now()+".jpg";await s.uploadFile({cloudPath:e,filePath:this.imgurl,success:async s=>{let e=await F.addGoods({title:this.selltitle,price:this.sellprice,imgUrl:s.fileID,seller:this.id,state:"selling"});this.selltitle="",console.log(e),this.sellprice="",this.imgurl="",this.isloading=!1,this.getgoods()}})}else o({title:"请将图片和信息填写完整",position:"center",duration:2e3})},async getuserinfo(){let s=await q.getuser({id:this.id});"error"==s?t({title:"获取用户数据失败"}):this.userinfo=s},getmsg(){let s=e("message");this.message=""==s?{msg:[]}:JSON.parse(e("message"))},start(){this.timer=setInterval((()=>{this.getmsg()}),2e3)}},mounted(){this.checklogin(),this.getgoods(),this.getuserinfo()},onShow(){this.getgoods(),this.getuserinfo(),this.start()},onHide(){clearInterval(this.timer)}},[["render",function(s,e,l,t,a,i){const o=v,V=u,F=C,q=x,G=I,O=U,z=j;return r(),c(V,null,{default:d((()=>[n(V,{class:"topbox"},{default:d((()=>[n(V,{class:"title"},{default:d((()=>[n(o,{onClick:e[0]||(e[0]=s=>a.choose=0),class:h({titlechoose:0==a.choose})},{default:d((()=>[f("海鲜市场")])),_:1},8,["class"]),n(o,{onClick:e[1]||(e[1]=s=>a.choose=1),class:h({titlechoose:1==a.choose})},{default:d((()=>[f("寄售")])),_:1},8,["class"]),n(o,{onClick:e[2]||(e[2]=s=>a.choose=2),class:h({titlechoose:2==a.choose})},{default:d((()=>[f("消息")])),_:1},8,["class"]),n(o,{onClick:e[3]||(e[3]=s=>a.choose=3),class:h({titlechoose:3==a.choose})},{default:d((()=>[f("我的")])),_:1},8,["class"])])),_:1})])),_:1}),n(V,{class:"appbox"},{default:d((()=>[n(z,{current:a.choose,onChange:i.changepage,duration:"100",class:"swiper"},{default:d((()=>[n(G,null,{default:d((()=>[n(V,{class:"shop"},{default:d((()=>[n(V,{class:"search"},{default:d((()=>[n(F,{onInput:i.searchgoods,class:"search-input"},null,8,["onInput"]),g("i",{class:"bi bi-search search-button"})])),_:1}),n(V,{class:"fitter"},{default:d((()=>[g("span",{onClick:e[4]||(e[4]=(...s)=>i.pricefitter&&i.pricefitter(...s)),class:h([0==a.fitterway[0]?"fitter-item":"fitter-item-unactive"])},[f("价格 "),g("i",{class:h(["bi",a.fitterway[1]?"bi-chevron-up":"bi-chevron-down"])},null,2)],2),g("span",{onClick:e[5]||(e[5]=(...s)=>i.datefitter&&i.datefitter(...s)),class:h([1==a.fitterway[0]?"fitter-item":"fitter-item-unactive"])},[f("发布时间 "),g("i",{class:h(["bi",a.fitterway[1]?"bi-chevron-up":"bi-chevron-down"])},null,2)],2)])),_:1}),n(V,{class:"goodlist"},{default:d((()=>[(r(!0),p(_,null,m(a.goodlist,(s=>w((r(),c(V,{onClick:e=>i.gotoxiangqing(s._id),class:"gooditem"},{default:d((()=>[n(q,{mode:"aspectFill",src:s.imgUrl,class:"goods-image"},null,8,["src"]),n(V,{class:"goods-title"},{default:d((()=>[f(y(s.title),1)])),_:2},1024),n(V,{class:"goods-price"},{default:d((()=>[f("￥"+y(s.price),1)])),_:2},1024)])),_:2},1032,["onClick"])),[[k,0!=s.show]]))),256)),n(V,{style:{height:"1px"},class:"gooditem"})])),_:1})])),_:1})])),_:1}),n(G,null,{default:d((()=>[n(V,{class:"sell"},{default:d((()=>[n(V,{onClick:i.chooseimg,class:"sell-cover"},{default:d((()=>[n(q,{src:a.imgurl,mode:"aspectFill"},null,8,["src"]),g("i",{class:"bi bi-cloud-arrow-up cover-edit"})])),_:1},8,["onClick"]),n(F,{modelValue:a.selltitle,"onUpdate:modelValue":e[6]||(e[6]=s=>a.selltitle=s),placeholder:"输入商品标题",class:"sell-title"},null,8,["modelValue"]),n(F,{modelValue:a.sellprice,"onUpdate:modelValue":e[7]||(e[7]=s=>a.sellprice=s),placeholder:"输入商品价格",class:"sell-price"},null,8,["modelValue"]),g("span",{class:"rmb"},"￥"),n(V,{style:b({backgroundColor:a.isloading?"#afb1ff":"#615cff"}),onClick:i.uploadGoods,class:"upload-button"},{default:d((()=>[f(y(a.isloading?"上传中...":"上架商品"),1),w(g("i",{class:"bi bi-cart-plus"},null,512),[[k,!a.isloading]])])),_:1},8,["style","onClick"])])),_:1})])),_:1}),n(G,null,{default:d((()=>[n(V,{class:"message"},{default:d((()=>[(r(!0),p(_,null,m(a.message.msg,(s=>(r(),c(V,{class:"messageitem"},{default:d((()=>[n(O,{url:"/pages/apps/ershou/chat?id="+s.id},{default:d((()=>[n(V,{style:b({filter:"hue-rotate("+s.id/360+"deg)"}),class:"avtar"},{default:d((()=>[f(y(s.name.slice(-1)),1)])),_:2},1032,["style"]),n(V,{class:"user"},{default:d((()=>[n(V,{class:"username"},{default:d((()=>[f(y(s.name),1)])),_:2},1024),n(V,{class:"usermessage"},{default:d((()=>[f(y(s.chat.text),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["url"])])),_:2},1024)))),256))])),_:1})])),_:1}),n(G,null,{default:d((()=>[n(V,{class:"my"},{default:d((()=>[n(V,{class:"myinfo"},{default:d((()=>[n(V,{class:"namebox"},{default:d((()=>[f(y(a.name),1)])),_:1}),n(V,{class:"idbox"},{default:d((()=>[f(y(a.id),1)])),_:1}),n(V,{class:"infocard"},{default:d((()=>[n(V,{class:"balance"},{default:d((()=>[f("余额:￥"+y(Math.round(a.userinfo.balance)),1)])),_:1}),n(V,{class:"getbalance"},{default:d((()=>[f("取现 "),g("i",{class:"bi bi-upload"})])),_:1})])),_:1}),n(V,{class:"icolist"},{default:d((()=>[n(O,{url:"/pages/apps/ershou/mysell"},{default:d((()=>[n(V,{class:"icoitem"},{default:d((()=>[g("i",{class:"bi bi-bag-check-fill"}),n(V,null,{default:d((()=>[f("我发布的")])),_:1}),n(o,{class:"dot"},{default:d((()=>[f(y(a.userinfo.mysell),1)])),_:1})])),_:1})])),_:1}),n(O,{url:"/pages/apps/ershou/mybuy"},{default:d((()=>[n(V,{class:"icoitem"},{default:d((()=>[g("i",{class:"bi bi-cart-check-fill"}),n(V,null,{default:d((()=>[f("我买到的")])),_:1}),n(o,{class:"dot"},{default:d((()=>[f(y(a.userinfo.mybuy),1)])),_:1})])),_:1})])),_:1}),n(O,{url:"/pages/apps/ershou/myselled"},{default:d((()=>[n(V,{class:"icoitem"},{default:d((()=>[g("i",{class:"bi bi-credit-card-fill"}),n(V,null,{default:d((()=>[f("我卖出的")])),_:1}),n(o,{class:"dot"},{default:d((()=>[f(y(a.userinfo.myselled),1)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),n(V,{class:"navlist"},{default:d((()=>[n(O,{url:"/pages/apps/ershou/dizhi"},{default:d((()=>[n(V,{class:"navitem"},{default:d((()=>[f(" 地址管理"),g("i",{class:"bi bi-geo-alt-fill"})])),_:1})])),_:1}),n(O,{url:"/pages/apps/ershou/shoucang"},{default:d((()=>[n(V,{class:"navitem"},{default:d((()=>[f(" 我的收藏"),g("i",{class:"bi bi-star-fill"})])),_:1})])),_:1}),n(V,{class:"navitem"},{default:d((()=>[f(" 账户绑定"),g("i",{class:"bi bi-alipay"})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["current","onChange"])])),_:1}),g("i",{onClick:e[8]||(e[8]=(...s)=>i.clickadd&&i.clickadd(...s)),style:b({rotate:1==a.choose?"45deg":"0deg"}),class:"bi bi-plus-lg add-button"},null,4)])),_:1})}],["__scopeId","data-v-c2718376"]]);export{G as default};
