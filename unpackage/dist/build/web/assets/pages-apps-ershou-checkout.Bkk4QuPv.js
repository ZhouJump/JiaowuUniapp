import{Y as s,l as a,h as e,M as o,C as t,c as i,w as l,i as d,o as r,a as c,f as p,t as n,e as u,q as h,O as g}from"./index-Dkb7w5wx.js";import{_ as f}from"./uni-pay.D2lROctx.js";import{r as m}from"./uni-app.es.D4vXMl6B.js";import{_}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./js_sdk.Dqq72uFy.js";const y=s.importObject("goods");s.importObject("uni-pay-co");const b=_({data:()=>({goods:{title:"加载中"},order:0,address:""}),methods:{success(s){},fail(s){this.order=2},async getgoods(s){let a=await y.getGoods(s);this.goods=a[0]},async alipay(){this.order=1,await this.$refs.pay.createOrder({provider:"alipay",total_fee:Math.round(100*(this.goods.price-0)),type:"test",order_no:"test"+Date.now(),description:this.goods.title})},async checkpay(){if(1==this.order){console.log("ok"),"sucess"==await y.byGoods({_id:this.goods._id,id:a("userid"),address:this.address})&&e({url:"/pages/apps/ershou/ershou"})}else 2==this.order&&(o({title:"支付失败"}),console.log("fail"))}},mounted(){this.getgoods()},onLoad(s){},onShow(){this.checkpay()}},[["render",function(s,a,e,o,_,y){const b=m(t("uni-pay"),f),j=d,w=h,k=g;return r(),i(j,{class:"page"},{default:l((()=>[c(b,{ref:"pay",height:"70vh",onSuccess:y.success,onFail:y.fail,logo:"/static/logo.png"},null,8,["onSuccess","onFail"]),c(j,{class:"topbox"},{default:l((()=>[c(j,{class:"title"},{default:l((()=>[p("订单详情")])),_:1})])),_:1}),c(j,{class:"appbox"},{default:l((()=>[c(w,{mode:"aspectFill",class:"mainimg",src:_.goods.imgUrl},null,8,["src"]),c(j,{class:"goods-title"},{default:l((()=>[p(n(_.goods.title),1)])),_:1}),c(k,{placeholder:"请简要描述交易时间地点等",modelValue:_.address,"onUpdate:modelValue":a[0]||(a[0]=s=>_.address=s),class:"address"},null,8,["modelValue"]),c(j,{class:"price"},{default:l((()=>[p("￥"+n(_.goods.price),1)])),_:1}),c(j,{class:"buttonpake"},{default:l((()=>[c(j,{onClick:y.alipay,class:"alipay"},{default:l((()=>[p("支付宝 "),u("i",{class:"bi bi-alipay"})])),_:1},8,["onClick"]),c(j,{class:"wechat"},{default:l((()=>[p("微信支付 "),u("i",{class:"bi bi-wechat"})])),_:1})])),_:1})])),_:1})])),_:1})}],["__scopeId","data-v-c4b1edd7"]]);export{b as default};
